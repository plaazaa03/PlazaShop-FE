<!-- Mostrar el carrito solo si el usuario está autenticado -->
<div *ngIf="isAuthenticated; else noSesion">
  <div class="carrito-container" *ngIf="carrito.length > 0; else vacio">
    <table>
      <thead>
        <tr>
          <th>Producto</th>
          <th>Cantidad</th>
          <th>Precio</th>
          <th>Total</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of carrito">
          <td>{{ item.producto.nombre }}</td>
          <td>
            <input type="number" [(ngModel)]="item.cantidad" min="1" (change)="actualizarTotal()" />
          </td>
          <td>{{ item.producto.precio | currency:'EUR' }}</td>
          <td>{{ item.producto.precio * item.cantidad | currency:'EUR' }}</td>
          <td><button (click)="eliminar(item.producto_id)">❌</button></td>
        </tr>
      </tbody>
    </table>

    <p><strong>Total:</strong> {{ total | currency:'EUR' }}</p>
    <button (click)="finalizarPedido()">Finalizar Pedido</button>
  </div>

  <!-- Carrito vacío -->
  <ng-template #vacio>
    <div class="carrito-vacio">
      <img src="img/carro-vacio.png" alt="Carrito vacío" class="icono-carrito" />
      <h2>Tu carrito está vacío</h2>
      <p>¡Explora nuestras categorías y encuentra lo que necesitas!</p>
      <a href="/productos" class="boton-sesion">Seguir comprando</a>
    </div>
  </ng-template>
</div>

<!-- Si el usuario NO está autenticado -->
<ng-template #noSesion>
  <div class="carrito-vacio">
    <img src="assets/icons/empty-cart.svg" alt="Debes iniciar sesión" class="icono-carrito" />
    <h2>Debes iniciar sesión</h2>
    <p>Accede a tu cuenta para ver tu carrito de compras.</p>
    <a routerLink="/login" class="boton-sesion">Iniciar sesión</a>
  </div>
</ng-template>
